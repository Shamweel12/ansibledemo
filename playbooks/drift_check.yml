- name: Detect manual VLAN changes (Drift Detection)
  hosts: all
  gather_facts: no

  tasks:
    - name: Check VLAN 1234 baseline
      cisco.ios.ios_config:
        parents: vlan 1234
        lines:
          - name MANAGED_BY_ANSIBLE
        match: exact
      check_mode: yes
      register: drift

    - name: Show drift result
      debug:
        msg: "VLAN drift detected = {{ drift.changed }}"

    - name: Fail job if drift detected
      fail:
        msg: "MANUAL VLAN CHANGE DETECTED â€” drift found"
      when: drift.changed

